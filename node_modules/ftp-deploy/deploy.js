/*
Used to upload the app

node deploy

Can be reconfigured to handle the db editor
*/

const path = require("path");

var FtpDeploy = require("/Users/simonhampton/code/nodejs/ftp-deploy/src/ftp-deploy.js");
var ftpDeploy = new FtpDeploy();

let args = require("minimist")(process.argv.slice(2));

var config = {
    user: "losvast.be",
    password: "6tr7UI!A",
    host: "ssh.losvast.be",
    port: 21,
    localRoot: path.join(__dirname, "dist"),
    remoteRoot: "",
    include: ["**/*"],
    // if true, only uploads changed files (based on last modified date and file size)
    newFilesOnly: true,
    exclude: [],
    sftp: false,
};

if (args.prod) {
    console.log("** Uploading to production");
    config.remoteRoot = "";
}

ftpDeploy.deploy(config, function (err) {
    if (err) console.log(err);
    else console.log("finished");
});

ftpDeploy.on("uploaded", function (data) {
    console.log("UPLOADED:", data); // same data as uploading event
});

ftpDeploy.on("upload-error", function (data) {
    console.log("upload-error", data); // data will also include filename, relativePath, and other goodies
});

ftpDeploy.on("error", function (data) {
    console.log("error", data); // data will also include filename, relativePath, and other goodies
});

ftpDeploy.on("log", function (data) {
    console.log("[log]", data); // data will also include filename, relativePath, and other goodies
});
